<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<!-- saved from url=(0043)http://avr.ru/beginer/understand/sleep_mode -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Спящий режим. Объяснялки. Сайт о микроконтроллерах AVR.RU</title>

<link rel="stylesheet" href="./Спящий режим AVR_files/shThemeDefault.css" type="text/css">
<link rel="stylesheet" href="./Спящий режим AVR_files/shCore.css" type="text/css">
<link rel="stylesheet" href="./Спящий режим AVR_files/main.css" type="text/css">
<script type="text/javascript" async="" src="./Спящий режим AVR_files/watch.js"></script><script type="text/javascript">
//<![CDATA[
var themeRoot = 'http://avr.ru/themes/avr/main';
//]]>
</script>
<script type="text/javascript" src="./Спящий режим AVR_files/shCore.js">//</script>
<script type="text/javascript" src="./Спящий режим AVR_files/shBrushJScript.js">//</script>
<script type="text/javascript" src="./Спящий режим AVR_files/shBrushDelphi.js">//</script>
<script type="text/javascript" src="./Спящий режим AVR_files/shBrushCpp.js">//</script>
<script type="text/javascript" src="./Спящий режим AVR_files/drop_down_menu.js">//</script>
<script type="text/javascript" src="./Спящий режим AVR_files/jquery.js">//</script>
<link rel="icon" href="http://avr.ru/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="http://avr.ru/favicon.ico" type="image/x-icon">
	 <meta name="yandex-verification" content="763524d7cc0ec91e">
	 <style type="text/css" id="ya_share_style">.b-share-popup-wrap{z-index:1073741823;position:absolute;width:500px}.b-share-popup{position:absolute;z-index:1073741823;border:1px solid #888;background:#FFF;color:#000}.b-share-popup-wrap .b-share-popup_down{top:0}.b-share-popup-wrap .b-share-popup_up{bottom:0}.b-share-popup-wrap_state_hidden{position:absolute!important;top:-9999px!important;right:auto!important;bottom:auto!important;left:-9999px!important;visibility:hidden!important}.b-share-popup,x:nth-child(1){border:0;padding:1px!important}@media all and (resolution=0){.b-share-popup,x:nth-child(1),x:-o-prefocus{padding:0!important;border:1px solid #888}}.b-share-popup__i{display:-moz-inline-box;display:inline-block;padding:5px 0!important;overflow:hidden;vertical-align:top;white-space:nowrap;visibility:visible;background:#FFF;-webkit-box-shadow:0 2px 9px rgba(0,0,0,.6);-moz-box-shadow:0 2px 9px rgba(0,0,0,.6);box-shadow:0 2px 9px rgba(0,0,0,.6)}.b-share-popup__item{font:1em/1.25em Arial,sans-serif;display:block;padding:5px 15px!important;white-space:nowrap;background:#FFF}.b-share-popup__item,a.b-share-popup__item:link,a.b-share-popup__item:visited{text-decoration:none!important;border:0!important}a.b-share-popup__item{cursor:pointer}a.b-share-popup__item .b-share-popup__item__text{display:inline;text-decoration:underline;color:#1A3DC1}a.b-share-popup__item:hover{word-spacing:0}a.b-share-popup__item:hover .b-share-popup__item__text{color:red;cursor:pointer}.b-share-popup__icon{display:-moz-inline-box;display:inline-block;margin:-3px 0 0;padding:0 5px 0 0!important;vertical-align:middle}.b-share-popup__icon_input{width:21px;height:16px;margin-top:-6px;padding:0!important}.b-share-popup__icon__input{margin-right:0;margin-left:2px;vertical-align:top}.b-share-popup__spacer{display:block;padding-top:10px!important}.b-share-popup__header{font:86%/1em Verdana,sans-serif;display:block;padding:10px 15px 5px!important;color:#999}.b-share-popup__header_first{padding-top:5px!important}.b-share-popup__input{font:86%/1em Verdana,sans-serif;display:block;padding:5px 15px!important;color:#999;text-align:left}.b-share-popup__input__input{font:1em/1em Verdana,sans-serif;display:block;width:10px;margin:5px 0 0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;resize:none;text-align:left;direction:ltr}.b-share-popup_down .b-share-popup_with-link .b-share-popup__input_link{position:absolute;top:5px;right:0;left:0}.b-share-popup_up .b-share-popup_with-link .b-share-popup__input_link{position:absolute;right:0;bottom:5px;left:0}.b-share-popup_down .b-share-popup_with-link{padding-top:55px!important}.b-share-popup_up .b-share-popup_with-link{padding-bottom:55px!important}.b-share-popup_down .b-share-popup_expandable .b-share-popup__main{padding-bottom:25px!important}.b-share-popup_up .b-share-popup_expandable .b-share-popup__main{padding-top:25px!important}.b-share-popup_down .b-share-popup_yandexed{padding-bottom:10px!important}.b-share-popup_up .b-share-popup_yandexed{padding-top:10px!important}.b-share-popup__yandex{position:absolute;right:4px;bottom:2px;font:78.125%/1em Verdana,sans-serif;padding:3px!important;background:0 0}a.b-share-popup__yandex:link,a.b-share-popup__yandex:visited{color:#C6C5C5;text-decoration:none}a.b-share-popup__yandex:link:hover,a.b-share-popup__yandex:visited:hover{color:red;text-decoration:underline}.b-share-popup_up .b-share-popup__yandex{top:2px;bottom:auto}.b-share-popup_expandable .b-share-popup__yandex{right:auto;left:4px}.b-share-popup_to-right .b-share-popup_expandable .b-share-popup__yandex{right:4px;left:auto}.b-share-popup__expander .b-share-popup__item{position:absolute;bottom:5px;font:86%/1em Verdana,sans-serif;margin:10px 0 0;padding:5px 10px!important;cursor:pointer;color:#999;background:0 0}.b-share-popup_to-right,.b-share-popup_to-right .b-share-popup__expander{direction:rtl}.b-share-popup_to-right .b-share-popup__expander .b-share-popup__icon{padding:0 0 0 5px!important}.b-share-popup_up .b-share-popup__expander .b-share-popup__item{top:-5px;bottom:auto}.b-share-popup__expander .b-share-popup__item:hover .b-share-popup__item__text{text-decoration:underline}.b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup__expander .b-ico_action_larr,.b-share-popup_full .b-share-popup__expander .b-ico_action_larr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup__expander .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__item__text_expand{display:none}.b-share-popup_to-right .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_full .b-share-popup__item__text_collapse,.b-share-popup_full .b-share-popup__expander .b-ico_action_rarr,.b-share-popup_to-right .b-share-popup_full .b-share-popup__expander .b-ico_action_larr{display:inline}.b-ico_action_rarr,.b-ico_action_larr{width:8px;height:7px;border:0}.b-share-popup__main,.b-share-popup__extra{direction:ltr;vertical-align:bottom;text-align:left}.b-share-popup_down .b-share-popup__main,.b-share-popup_down .b-share-popup__extra{vertical-align:top}.b-share-popup__main{display:-moz-inline-stack;display:inline-block}.b-share-popup__extra{display:none;margin:0 -10px 0 0}.b-share-popup_full .b-share-popup__extra{display:-moz-inline-stack;display:inline-block}.b-share-popup_to-right .b-share-popup__extra{margin:0 0 0 -10px}.b-share-popup__tail{position:absolute;width:21px;height:10px;margin:0 0 0 -11px}.b-share-popup_down .b-share-popup__tail{top:-10px;background:url("//yastatic.net/share/static/b-share-popup_down__tail.gif") 0 0 no-repeat}.b-share-popup_up .b-share-popup__tail{bottom:-10px;background:url("//yastatic.net/share/static/b-share-popup_up__tail.gif") 0 0 no-repeat}.b-share-popup_down .b-share-popup__tail,x:nth-child(1){top:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.png")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1){bottom:-9px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.png")}@media all and (resolution=0){.b-share-popup_down .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{top:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_down__tail.gif")}.b-share-popup_up .b-share-popup__tail,x:nth-child(1),x:-o-prefocus{bottom:-10px;background-image:url("//yastatic.net/share/static/b-share-popup_up__tail.gif")}}.b-share-popup .b-share-popup_show_form_mail,.b-share-popup .b-share-popup_show_form_html{padding:0!important}.b-share-popup .b-share-popup_show_form_mail .b-share-popup__main,.b-share-popup .b-share-popup_show_form_html .b-share-popup__main,.b-share-popup .b-share-popup_show_form .b-share-popup__main,.b-share-popup .b-share-popup_show_form_mail .b-share-popup__extra,.b-share-popup .b-share-popup_show_form_html .b-share-popup__extra,.b-share-popup .b-share-popup_show_form .b-share-popup__extra{height:15px;padding:0!important;overflow:hidden;visibility:hidden}.b-share-popup_show_form_mail .b-share-popup__expander,.b-share-popup_show_form_html .b-share-popup__expander,.b-share-popup_show_form .b-share-popup__expander,.b-share-popup_show_form_mail .b-share-popup__input_link,.b-share-popup_show_form_html .b-share-popup__input_link,.b-share-popup_show_form .b-share-popup__input_link{display:none}.b-share-popup__form{position:relative;display:none;overflow:hidden;padding:5px 0 0!important;margin:0 0 -15px;white-space:normal}.b-share-popup_show_form_mail .b-share-popup__form_mail,.b-share-popup_show_form_html .b-share-popup__form_html,.b-share-popup_show_form .b-share-popup__form{display:block}.b-share-popup__form__link{padding:5px!important;margin:0 0 5px 10px;text-decoration:underline;cursor:pointer;color:#1A3DC1}.b-share-popup__form__link,.b-share-popup__form__button{font:86%/1.4545em Verdana,sans-serif;float:left;display:inline}.b-share-popup__form__button{margin:5px 0 0 15px}.b-share-popup__form__close{font:86%/1.4545em Verdana,sans-serif;float:right;display:inline;padding:5px!important;margin:0 10px 5px 0;cursor:pointer;color:#999}a.b-share-popup__form__link:hover,a.b-share-popup__form__close:hover{text-decoration:underline;color:red}.b-share-popup_font_fixed .b-share-popup__item{font-size:12.8px}.b-share-popup_font_fixed .b-share-popup__header,.b-share-popup_font_fixed .b-share-popup__input,.b-share-popup_font_fixed .b-share-popup__expander .b-share-popup__item,.b-share-popup_font_fixed .b-share-popup__form__link,.b-share-popup_font_fixed .b-share-popup__form__button,.b-share-popup_font_fixed .b-share-popup__form__close{font-size:11px}.b-share-popup_font_fixed .b-share-popup__yandex{font-size:10px}.b-share-form-button{font:86%/17px Verdana,Arial,sans-serif;display:-moz-inline-box;display:inline-block;position:relative;height:19px;margin:0 3px;padding:0 4px;cursor:default;white-space:nowrap;text-decoration:none!important;color:#000!important;border:none;outline:none;background:url("//yastatic.net/share/static/b-share-form-button.png") 0 -20px repeat-x}.b-share-form-button:link:hover,.b-share-form-button:visited:hover{color:#000!important}.b-share-form-button__before,.b-share-form-button__after{position:absolute;width:3px;height:19px;background:url("//yastatic.net/share/static/b-share-form-button.png")}.b-share-form-button__before{margin-left:-7px}.b-share-form-button__after{margin-left:4px;background-position:-3px 0}.b-share-form-button::-moz-focus-inner{border:none}button.b-share-form-button .b-share-form-button__before,button.b-share-form-button .b-share-form-button__after{margin-top:-1px}@-moz-document url-prefix(){button.b-share-form-button .b-share-form-button__after{margin-top:-2px;margin-left:6px}button.b-share-form-button .b-share-form-button__before{margin-top:-2px;margin-left:-9px}}SPAN.b-share-form-button:hover,.b-share-form-button_state_hover{background-position:0 -60px}SPAN.b-share-form-button:hover .b-share-form-button__before,.b-share-form-button_state_hover .b-share-form-button__before{background-position:0 -40px}SPAN.b-share-form-button:hover .b-share-form-button__after,.b-share-form-button_state_hover .b-share-form-button__after{background-position:-3px -40px}.b-share-form-button_state_pressed,.b-share-form-button_state_pressed .b-share-form-button_share{background-position:0 -100px!important}.b-share-form-button_state_pressed .b-share-form-button__before{background-position:0 -80px!important}.b-share-form-button_state_pressed .b-share-form-button__after{background-position:-3px -80px!important}button.b-share-form-button_state_pressed{overflow:visible}.b-share-form-button_icons{position:relative;padding:0;background-position:0 -20px!important}.b-share-form-button_icons .b-share-form-button__before{left:0;margin-left:-3px;background-position:0 0!important}.b-share-form-button_icons .b-share-form-button__after{z-index:-1;margin-left:0;background-position:-3px 0!important}.b-share-form-button_icons .b-share__handle{padding:2px!important}.b-share-form-button_icons .b-share__handle_more{position:relative;padding-right:6px!important;margin-right:-4px}.b-share-form-button_icons .b-share-icon{opacity:.5;background-image:url("//yastatic.net/share/static/b-share-icon_size_14.png")}.b-share-form-button_icons A.b-share__handle:hover .b-share-icon{opacity:1}.b-share{font:86%/1.4545em Arial,sans-serif;display:-moz-inline-box;display:inline-block;padding:1px 3px 1px 4px!important;vertical-align:middle}.b-share .b-share-form-button{font-size:1em}.b-share__text .b-share-icon{margin:0 5px 0 0;border:none}.b-share__text{margin-right:5px}.b-share__handle{float:left;height:16px;padding:5px 3px 5px 2px!important;cursor:pointer;text-align:left;text-decoration:none!important}.b-share__handle_cursor_default{cursor:default}.b-share__handle .b-share-form-button{margin-top:-2px}.b-share__hr{display:none;float:left;width:1px;height:26px;margin:0 3px 0 2px}a.b-share__handle:hover .b-share__text{text-decoration:underline;color:red}.b-share_bordered{padding:0 2px 0 3px!important;border:1px solid #E4E4E4;-moz-border-radius:5px;-webkit-border-radius:5px;border-radius:5px}.b-share_bordered .b-share__hr{display:inline;background:#E4E4E4}.b-share_link{margin:-8px 0}a.b-share_link{margin:0}.b-share_link .b-share__text{text-decoration:underline;color:#1A3DC1}.b-share-form-button_share{padding-left:26px!important;vertical-align:top}.b-share-form-button_share .b-share-form-button__before{margin-left:-29px}.b-share-form-button_share .b-share-form-button__icon{position:absolute;width:20px;height:17px;margin:1px 0 0 -23px;background:url("//yastatic.net/share/static/b-share-form-button_share__icon.png") 0 0 no-repeat}.b-share-pseudo-link{border-bottom:1px dotted;cursor:pointer;text-decoration:none!important}.b-share_font_fixed{font-size:11px}.b-share__handle_more{font-size:9px;margin-top:-1px;color:#7B7B7B}A.b-share__handle_more:hover{color:#000}.b-share__group{float:left}.b-share-icon{float:left;display:inline;overflow:hidden;width:16px;height:16px;padding:0!important;vertical-align:top;border:0;background:url("//yastatic.net/share/static/b-share-icon.png") 0 99px no-repeat}.b-share-icon_vkontakte,.b-share-icon_custom{background-position:0 0}.b-share-icon_yaru,.b-share-icon_yaru_photo,.b-share-icon_yaru_wishlist{background-position:0 -17px}.b-share-icon_lj{background-position:0 -34px}.b-share-icon_twitter{background-position:0 -51px}.b-share-icon_facebook{background-position:0 -68px}.b-share-icon_moimir{background-position:0 -85px}.b-share-icon_friendfeed{background-position:0 -102px}.b-share-icon_mail{background-position:0 -119px}.b-share-icon_html{background-position:0 -136px}.b-share-icon_postcard{background-position:0 -153px}.b-share-icon_odnoklassniki{background-position:0 -170px}.b-share-icon_blogger{background-position:0 -187px}.b-share-icon_delicious{background-position:0 -221px}.b-share-icon_gbuzz{background-position:0 -238px}.b-share-icon_linkedin{background-position:0 -255px}.b-share-icon_myspace{background-position:0 -272px}.b-share-icon_evernote{background-position:0 -289px}.b-share-icon_digg{background-position:0 -306px}.b-share-icon_juick{background-position:0 -324px}.b-share-icon_moikrug{background-position:0 -341px}.b-share-icon_yazakladki{background-position:0 -358px}.b-share-icon_liveinternet{background-position:0 -375px}.b-share-icon_tutby{background-position:0 -392px}.b-share-icon_diary{background-position:0 -409px}.b-share-icon_gplus{background-position:0 -426px}.b-share-icon_pocket{background-position:0 -443px}.b-share-icon_surfingbird{background-position:0 -460px}.b-share-icon_pinterest{background-position:0 -477px}.b-share-icon_renren{background-position:0 0}.b-share-icon_renren,.b-share-icon_sina_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_sina_weibo{background-position:-18px 0}.b-share-icon_qzone{background-position:-36px 0}.b-share-icon_qzone,.b-share-icon_tencent_weibo{background:url("//yastatic.net/share/static/b-share-icon__china.png") no-repeat}.b-share-icon_tencent_weibo{background-position:-54px 0}.b-share_theme_dark .b-share-icon{background:url("//yastatic.net/share/static/b-share-icons__theme_dark.png") 99px 0 no-repeat}.b-share_theme_dark .b-share-icon_odnoklassniki{background-position:-4px -3px}.b-share_theme_dark .b-share-icon_vkontakte{background-position:-24px -3px}.b-share_theme_dark .b-share-icon_twitter{background-position:-44px -3px}.b-share_theme_dark .b-share-icon_facebook{background-position:-64px -3px}.b-share_theme_dark .b-share-icon_lj{background-position:-85px -3px}.b-share_theme_dark .b-share-icon_yaru{background-position:-105px -3px}.b-share_theme_dark .b-share-popup .b-share-icon_odnoklassniki,.b-share_theme_dark .b-share-icon_odnoklassniki:hover{background-position:-4px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_vkontakte,.b-share_theme_dark .b-share-icon_vkontakte:hover{background-position:-24px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_twitter,.b-share_theme_dark .b-share-icon_twitter:hover{background-position:-44px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_facebook,.b-share_theme_dark .b-share-icon_facebook:hover{background-position:-64px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_lj,.b-share_theme_dark .b-share-icon_lj:hover{background-position:-85px -28px}.b-share_theme_dark .b-share-popup .b-share-icon_yaru,.b-share_theme_dark .b-share-icon_yaru:hover{background-position:-105px -28px}.b-share_theme_dark .b-share-form-button_share .b-share-form-button__icon{background-image:url("//yastatic.net/share/static/b-share-form-button_share__icon_dark.png")}.b-share_theme_dark .b-share-form-button{color:#fff!important;opacity:.8}.b-share_theme_dark .b-share__handle:hover .b-share-form-button,.b-share_theme_dark .b-share-form-button:hover{opacity:1;cursor:pointer}.b-share_theme_dark .b-share-form-button,.b-share_theme_dark .b-share-form-button__before,.b-share_theme_dark .b-share-form-button__after{background:0 0}.b-share_theme_dark .b-share-popup__i{background-color:#333;border-radius:10px;-webkit-box-shadow:0 2px 9px rgba(255,255,255,.6);-moz-box-shadow:0 2px 9px rgba(255,255,255,.6);box-shadow:0 2px 9px rgba(255,255,255,.6)}.b-share_theme_dark .b-share__text{color:#AAA}.b-share_theme_dark .b-share-popup{color:#AAA;border-radius:10px;background-color:#333;background-color:rgba(50,50,50,.3)}.b-share_theme_dark .b-share-popup__item{background:0 0;color:#ccc}.b-share_theme_dark .b-share-popup .b-share-popup__item__text{color:#ccc}.b-share_theme_counter .b-share{display:inline-block;vertical-align:middle;white-space:nowrap}.b-share-counter{font:14px Arial,sans-serif;line-height:18px;display:none;float:left;margin:3px 6px 3px 3px;color:#fff}.b-share_theme_counter .b-share_type_small .b-share-counter{font-size:11px;line-height:14px;margin:2px 6px 2px 1px}.b-share_theme_counter .b-share-btn__counter .b-share-counter{display:block}.b-share-btn__counter{text-decoration:none}.b-share_theme_counter .b-share-btn__wrap{position:relative;float:left;margin-left:5px}.b-share_theme_counter .b-share_type_small .b-share-btn__wrap{margin-left:4px}.b-share_theme_counter .b-share-btn__wrap:first-child{margin-left:0}.b-share_theme_counter .b-share__link{display:inline-block;cursor:pointer;-webkit-border-radius:3px;border-radius:3px}.b-share_theme_counter .b-share_type_small .b-share__link{-webkit-border-radius:2px;border-radius:2px}.b-share_theme_counter .b-share-icon{display:block;float:left;width:24px;height:24px;background-image:url("//yastatic.net/share/static/b-share_counter_large.png");background-position:-20px 0}.b-share_theme_counter .b-share_type_small .b-share-icon{width:18px;height:18px;background-image:url("//yastatic.net/share/static/b-share_counter_small.png")}.b-share_theme_counter .b-share-icon_facebook{background-position:0 0}.b-share_theme_counter .b-share-btn__facebook{background-color:#3c5a98}.b-share_theme_counter .b-share-btn__facebook:hover{background-color:#30487a}.b-share_theme_counter .b-share-btn__facebook:active{border-top:2px solid #24365a;background-color:#334d81}.b-share_theme_counter .b-share-icon_moimir{background-position:0 -29px}.b-share_theme_counter .b-share-btn__moimir{background-color:#226eb7}.b-share_theme_counter .b-share-btn__moimir:hover{background-color:#1b5892}.b-share_theme_counter .b-share-btn__moimir:active{border-top:2px solid #14426d;background-color:#1d5e9c}.b-share_theme_counter .b-share-icon_vkontakte{background-position:0 -58px}.b-share_theme_counter .b-share-btn__vkontakte{background-color:#48729e}.b-share_theme_counter .b-share-btn__vkontakte:hover{background-color:#3a5b7e}.b-share_theme_counter .b-share-btn__vkontakte:active{border-top:2px solid #2b445e;background-color:#3d6186}.b-share_theme_counter .b-share-icon_twitter{background-position:0 -87px}.b-share_theme_counter .b-share-btn__twitter{background-color:#00aced}.b-share_theme_counter .b-share-btn__twitter:hover{background-color:#008abe}.b-share_theme_counter .b-share-btn__twitter:active{border-top:2px solid #00668d;background-color:#0092ca}.b-share_theme_counter .b-share-icon_odnoklassniki{background-position:0 -116px}.b-share_theme_counter .b-share-btn__odnoklassniki{background-color:#ff9f4d}.b-share_theme_counter .b-share-btn__odnoklassniki:hover{background-color:#cc7f3e}.b-share_theme_counter .b-share-btn__odnoklassniki:active{border-top:2px solid #975e2e;background-color:#d98742}.b-share_theme_counter .b-share-icon_gplus{background-position:0 -145px}.b-share_theme_counter .b-share-btn__gplus{background-color:#c25234}.b-share_theme_counter .b-share-btn__gplus:hover{background-color:#9b422a}.b-share_theme_counter .b-share-btn__gplus:active{border-top:2px solid #73311f;background-color:#a5462c}.b-share_theme_counter .b-share-icon_yaru{background-position:0 -174px}.b-share_theme_counter .b-share-btn__yaru{background-color:#d83933}.b-share_theme_counter .b-share-btn__yaru:hover{background-color:#ad2e29}.b-share_theme_counter .b-share-btn__yaru:active{border-top:2px solid #80221e;background-color:#b8312b}.b-share_theme_counter .b-share-icon_pinterest{background-position:0 -203px}.b-share_theme_counter .b-share-btn__pinterest{background-color:#cd1e27}.b-share_theme_counter .b-share-btn__pinterest:hover{background-color:#a4181f}.b-share_theme_counter .b-share-btn__pinterest:active{border-top:2px solid #7b1217;background-color:#ae1921}.b-share_theme_counter .b-share__link:active{height:22px}.b-share_theme_counter .b-share_type_small .b-share__link:active{height:16px}.b-share_theme_counter .b-share__link:active .b-share-icon,.b-share_theme_counter .b-share__link:active .b-share-counter{position:relative;top:-1px}.b-share_theme_counter .b-share__link::after{position:absolute;top:0;right:0;bottom:0;left:0;content:"";background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==)}.b-share_theme_counter .b-share__handle{height:auto;padding:0!important}</style></head>
<body>
  

<div id="header">
<a id="sitemap" href="http://avr.ru/site_map"><img src="./Спящий режим AVR_files/sitemap.png" alt="sitemap" title="Карта сайта"></a> <noindex><a id="print" href="http://avr.ru/beginer/understand/sleep_mode?version_for_print=true" rel="nofollow"><img src="./Спящий режим AVR_files/print.png" alt="print" title="Версия для печати"></a></noindex> <a id="title" href="http://avr.ru/">www.avr.ru</a>
</div><div class="dropDownMenu" id="ddm3" style="top: 54px; left: 318px;"><div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/understand/prot">Протоколы</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/understand/1wire">1-Wire</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/understand/ds18s20">ds1820</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/understand/ds18s20vsds18b20">ds18s20 vs ds18b20</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/understand/interrupt">Прерывания</a></div> </div><div class="dropDownMenu" id="ddm2" style="top: 54px; left: 217px;"><div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/avrsbs">AVR шаг за шагом.</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/bascom">BASCOM  для  начинающих</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/c_and_pascal">microC и microPascal</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/beginer/devices">Создание устройств</a></div> </div><div class="dropDownMenu" id="ddm1" style="top: 54px; left: 129px;"><div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://forum.avr.ru/">Форум</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/docs">Информация</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/tools">Инструмент</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/ready">Решения</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/news">Новости</a></div> <div><img src="./Спящий режим AVR_files/dlm.png" alt="&gt;"> <a href="http://avr.ru/useful">Полезности</a></div> </div>

<div id="menu">

<a id="logo" href="http://avr.ru/"><img src="./Спящий режим AVR_files/logo.png" alt="www.avr.ru" title="В начало сайта"></a>

<div id="bread_crumbs">
<a href="http://avr.ru/">AVR.RU</a>
<img src="./Спящий режим AVR_files/dlm.png" alt="&gt;">
<a href="http://avr.ru/beginer">Новичкам</a>
<img src="./Спящий режим AVR_files/dlm.png" alt="&gt;">
<a href="http://avr.ru/beginer/understand">Объяснялки</a>
<img src="./Спящий режим AVR_files/dlm.png" alt="&gt;">
<span>Спящий режим</span></div>
 

<div id="noscriptmenu">


<div class="level_menu" id="lm1" style="display: none;">
<a href="http://forum.avr.ru/">Форум</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer">Новичкам</a>&nbsp;<span>|</span>
<a href="http://avr.ru/docs">Информация</a>&nbsp;<span>|</span>
<a href="http://avr.ru/tools">Инструмент</a>&nbsp;<span>|</span>
<a href="http://avr.ru/ready">Решения</a>&nbsp;<span>|</span>
<a href="http://avr.ru/news">Новости</a>&nbsp;<span>|</span>
<a href="http://avr.ru/useful">Полезности</a>
</div>

<div class="level_menu" id="lm2" style="display: none;">
<a href="http://avr.ru/beginer/avrsbs">AVR шаг за шагом.</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/bascom">BASCOM  для  начинающих</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/c_and_pascal">microC и microPascal</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/understand">Объяснялки</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/devices">Создание устройств</a>
</div>

<div class="level_menu" id="lm3" style="display: none;">
<a href="http://avr.ru/beginer/understand/prot">Протоколы</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/understand/1wire">1-Wire</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/understand/ds18s20">ds1820</a>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/understand/ds18s20vsds18b20">ds18s20 vs ds18b20</a>&nbsp;<span>|</span>
<span>Спящий режим</span>&nbsp;<span>|</span>
<a href="http://avr.ru/beginer/understand/interrupt">Прерывания</a>
</div>

</div>

<script type="text/javascript">
//<![CDATA[
dropDownMenu(); 
//]]>
</script>


</div>

<div id="container">
 
<div id="right">
&nbsp;
</div>

<div id="left">
<div id="content">

<h1 id="h1">Спящий режим</h1>
<div align="justify">
<p>Микросхема стала кушать слишком много энергии?<br> Перестало хватать мелочи на батарейки?<br> Тогда спящий режим идёт к Вам!<br>
  Проблема ненасытной микросхемы возникла, когда маленькое  устройство – генератор одноразовых паролей – сначала даже не смогло включиться от батарейки cr2032, а потом и вовсе покалечило программатор – сгорел светодиодик, не выдержав большого тока. Тогда проблема отложилась – кое-как, с понижением частоты работы, с выключением подсветки у дисплея и прочих плясок, а то сдавать надо было в тот же день, разбираться времени не было – но работала кроха считанные минуты…<br> Но вот теперь пора все-таки разобраться!</p>
<p>Посмотрим, почему микросхема вообще кушает энергию: в ней есть много-много транзисторов, работающих в так называемом ключевом режиме (по типу обычной кнопки). Основное потребление мощности идет в момент переключения ключа (<span style="color: red;">здесь когда-нибудь будет ссылка на статейку "как устроена микросхема"</span>), то есть чем меньше переключений - тем меньше потребляет чип. Переключения происходят в основном по тактовому импульсу, соответственно, чем меньше их число (тактовая частота), тем меньше потребление. При этом нужно помнить, что точность осциллятора (генератора наших тиков-тактов) тем выше, чем выше частота - именно поэтому во многих микросхемах есть внутренний делитель на 8 частоты осциллятора, и тогда, с одной стороны, снижается частота работы микросхемы, а следовательно, и энергопотребление, а с другой - точность остается достаточной для работы с такими чувствительными к косякам точности устройствам, как последовательный интерфейс USART.</p>
<p>Если же оставить все как есть, то сам чип на 8 МГц потребляет примерно 10,2 мА. В щелочной же пальчиковой батарейке - 1700-3000 мА * ч. Получается, что микросхема проработает от 17 часов до 12 суток - а правильную "большую" батарейку нужно поискать! (а в плоской литиевой, которую мы использовали - вообще 210 мА * ч, горе-печаль-беда Т_Т)</p>
<p>В общем, вариант "оставить все как есть" совершенно не прокатывает для автономных устройств, таких как пульты от телевизора, дистанционные выключатели, беспроводные звонки, устройства охраны, часы и метеостанции с ЖКИ, и примочки для LaserTag &#710;&#710;</p>
<p>Есть достаточно способов снизить потребление микросхемы:</p>
<ol>
<li>уменьшить частоту осциллятора</li>
<li>вообще выключить осциллятор</li>
<li>уменьшить количество переключающихся вентелей, отключив ядро и/или дополнительные генераторы и таймеры</li>
<li>отключить аналоговую периферию, которая требует кучу энергии</li>
<li>перевести какие только можно ножки в Z-состояние (<span style="color: red;">здесь когда-нибудь будет ссылка на статейку "как устроена микросхема"</span>)</li>
</ol>
<p>Часть этих способов автоматически выполняется при включении спящего режима. Рассмотрим их подробнее:</p>

<ul>
<li>Idle – в этом режиме отключается CPU – процессор, наш обработчик команд – и, соответственно, flash-память. При этом остаются включенными последовательный интерфейс SPI, USART, аналоговый компаратор, аналого-цифровой преобразователь (ADC), интерфейс TWI – он же I2C, все таймеры, в том числе и сторжевой, ну и система прерываний. Если нам что-нибудь не нужно – компаратор, АЦП или сторжевой таймер, то до засыпания можно отключить это ручками, и сэкономим ещё больше.<br> Этот режим буквально создан для работы с периферией, когда нужно быстро проснуться по команде от внешних интерфейсов и не тормозить. Получается даже не сон, а так... легкая дрема</li>
</ul>
<ul>
<li>Power-Down - тут останавливается практически всё, кроме обработки внешних прерываний, интерфейса TWI и сторжевого таймера. <br>Вызывать в таком состоянии прерывания могут только внешний сброс-reset, сброс по сторжевому таймеру, при провале напряжения. Также возможны прерывания при работе TWI и внешние прерывания.<br> Большинство счётчиков и таймеров тут тоже останавливаются – таким образом, в таком режиме с микросхемой могут работать только асинхронные интерфейсы. <br> В общем, тут чип засыпает намертво, проснуться самому ему достаточно проблематично, а уж если разбудили - просыпаться он будет мучительно долго, пропуская мимо ножек всю информацию от прерываний, например(</li>
</ul>
Idle и Power-Down встречаются наиболее часто.<br>
<ul>
<li>Power-save - этот режим похож на Power-down, но если таймер2 установлен в асинхронном режиме - бит ACCP.AS2 = 1 - то он будет работать; если таймер2 так не установлен, то даташит советует использовать Power-down - при пробуждении регистр этого таймера будет не определён.<br> Здесь микросхема погружена в глубокий сон , но где-то глубоко в подсознании чип про себя отмечает, сколько времени он проспал. Этот режим хорош для устройств, требующих знания о частоте выхода из спящего режима, например, для часов. Но, к сожалению, он не подходит для точного измерения временных отрезков между событиями.<span style="color: red;"><br></span></li>
<li>Standby - он тоже похож на Power-down, но используется при работе от внешнего источника тактирования и оставляет включённым осциллятор, а включенный осцилятор означает меньше времени на раскачку - быстрее старт. Этот режим используется, если нужно поймать какое-либо событие - например, в клавиатуре чипу надо проснуться до того, как пользователь отпустит клавишу. Ещё один красивый пример - автоспуск пленочного фотоаппарата на молнию.</li>
<li>Extended Standby - похож на Power-Save, но оставляет включённым осциллятор. Вот этот режим как раз для устройств, которым нужно точно знать, сколько времени прошло после входа в режим сна - например, для измерителя скорости вращения колеса велосипеда.</li>
</ul>
<p>Наконец, режим, стоящий особняком:</p>
<ul>
<li>ADC Noise Reduction. Этот режим останавливает процессор, но оставляет работать АЦП, систему внешних прерываний, интерфейс TWI, сторжевой таймер и таймер/счётчик2; соответственно, останавливаются только часы I/O, CPU и FLASH. Все это предназначено для того, чтобы уменьшить внутренние помехи (возникающие при переключении транзисторов самой микросхемы) при работе АЦП - так получаются измерения более высокой точности.</li>
</ul>
<p>Получаем следующие таблички:</p>
<p>Дрема - чип просыпается практически мгновенно:</p>
<table border="1" style="text-align:center; vertical-align:middle;">
<tbody>
<tr>
<td width="180">Почти вся периферия выключена</td>
<td width="180">Выключена только самая "шумная" периферия</td>
</tr>
<tr>
<td>Idle</td>
<td>Noise Reduction</td>
</tr>
</tbody>
</table>
<p>Сон - сильно уменьшает потребление энергии:</p>
<table border="1" style="text-align:center; vertical-align:middle;">
<tbody>
<tr>
<td width="233"></td>
<td width="120">Просыпаемся медленно</td>
<td width="120">Просыпаемся быстро</td>
</tr>
<tr>
<td>не знаем сколько времени прошло<br>и можем проснуться только извне</td>
<td>Power-down</td>
<td>Stand By</td>
</tr>
<tr>
<td>знаем сколько времени прошло<br>и можем проснуться по таймеру</td>
<td>Power-Save</td>
<td>Extended Stand By</td>
</tr>
</tbody>
</table>
<p>А вот и принцип работы программы:</p>
<p align="center"><img src="./Спящий режим AVR_files/Prog-algorithm.png" alt="Алгоритм работы программ" width="350" height="373"><br>Рис. 1. Работа программы со спящим режимом и программы без экономии электропитания</p>
<p>Получается, что в большинстве режимов микросхема вообще не понимает, что была в спящем режиме: только-только выполнила последнюю перед sleep; команду, а тут уже какое-то прерывание дергает.</p>
<p>А теперь посмотрим техническую часть)</p>
<p>За работу со спящими режимами отвечает регистр MCUCR</p>
<p align="center"><img src="./Спящий режим AVR_files/reg-MCUCR.png" alt="Регистр MCUCR" width="500" height="97"><br>Рис. 2. Регистр MCUCR в ATtiny 2313 и ATmega 8/32</p>
<p>Нам потребуются биты SM0, SM1 И SM2, если он есть - чтобы задать тип спящего режима. Так, например, в ATmega8 спящие режимы задаются так:</p>
<p align="center"><img src="./Спящий режим AVR_files/Sleep-mods.png" alt="Определение спящих режимов в ATmega8" width="400" height="188"><br>Рис. 3. Определение спящих режимов в ATmega8</p>
<p>После определения с типом режима остается только разрешить его - установить бит SE в 1.</p>
<p>Ну и, наконец, останется перевести в нужный момент микросхемку баинькать - ассемблеровской командой asm sleep;, нужно будет только продумать выход)</p>
<p>Вот пример программки для atmega8, у которой на выводе INT0 (PD2) есть кнопка, а на PB0 висит светодиодик; нажимаем на кнопку - светодиодик немножко горит и уходит в спящий режим до следующего нажатия.</p>
<div><div id="highlighter_836646" class="syntaxhighlighter  cpp"><div class="toolbar"><span><a href="http://avr.ru/beginer/understand/sleep_mode#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp comments">//переопределяем типы</code></div><div class="line number2 index1 alt1"><code class="cpp keyword bold">typedef</code> <code class="cpp plain">unsigned </code><code class="cpp color1 bold">char</code> <code class="cpp plain">byte;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="cpp plain">sbit ddrButton at ddD2_bit;&nbsp; </code><code class="cpp comments">//кнопка генерации</code></div><div class="line number5 index4 alt2"><code class="cpp plain">sbit pinButton at pinD2_bit;</code></div><div class="line number6 index5 alt1"><code class="cpp plain">sbit portButton at portD2_bit;</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="cpp plain">sbit ddrLight at ddB0_bit;&nbsp; </code><code class="cpp comments">//вывод для светодиода, на выход с подтяжкой, включается 0 по кнопке</code></div><div class="line number9 index8 alt2"><code class="cpp plain">sbit portLight at portB0_bit;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="cpp plain">byte flagButton = 0; </code><code class="cpp comments">//флаг нажатия кнопки; нажата - 1</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">INT0_interrupt() iv IVT_ADDR_INT0 </code><code class="cpp comments">//нужно написать как минимум пустую функцию -</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//потому что компилятор сам не создает. Иначе не работает</code></div><div class="line number15 index14 alt2"><code class="cpp plain">{</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">flagButton = 1;</code></div><div class="line number17 index16 alt2"><code class="cpp plain">}</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="cpp comments">//обработка нажатия кнопки - с учётом дребезга</code></div><div class="line number20 index19 alt1"><code class="cpp keyword bold">void</code> <code class="cpp plain">buttonLight()</code></div><div class="line number21 index20 alt2"><code class="cpp plain">{</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(flagButton) </code><code class="cpp comments">//если нажата кнопка</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portLight = 0;&nbsp;&nbsp; </code><code class="cpp comments">//включаем светодиод</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">delay_ms(500);</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portLight = 1;&nbsp;&nbsp; </code><code class="cpp comments">//выключаем светодиод</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">flagButton = 0;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp plain">}</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="cpp keyword bold">void</code> <code class="cpp plain">main()</code></div><div class="line number32 index31 alt1"><code class="cpp plain">{</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//инициализация всех используемых портов</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ddrB =&nbsp; 0;</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portB = 0;</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ddrD =&nbsp; 0;</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portD = 0;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//инициализация кнопки - на вход с подтяжкой</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portButton = 1;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ddrButton = 0;</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//инициализация светодиодика, которая включается по 0 и нажатию кнопки - на выход и в 1</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">portLight = 1;</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">ddrLight = 1;</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//настраиваем на внешние прерывания</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">GICR.INT0 = 1; </code><code class="cpp comments">//разрешаем внешнее прерывание INT0</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.ISC00 = 0;&nbsp; </code><code class="cpp comments">//прерывание генерируется по логическому 0 на INT0</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.ISC01 = 0;</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">asm sei;</code><code class="cpp comments">//SREG.B7 = 1; //разрешаем прерывания в принципе (бит I); команды аналогичны</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//определяем спящий режим&nbsp; :&nbsp;&nbsp; SM2-SM1-SM0 = 000 - режим Idle; 010 - PowerDown</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.SM2 = 0;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.SM1 = 1;</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.SM0 = 0;</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">MCUCR.SE = 1;&nbsp; </code><code class="cpp comments">//разрешили спящий режим</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(1)</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">buttonLight();</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">asm sleep;&nbsp; </code><code class="cpp comments">//в спящий режим</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number60 index59 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table></div></div>
<p>Программка работает и в режиме Idle, и в режиме Power-down. Но при этом в процессе написания и отладки было выяснено, что в даташите не просто так написано, что в режиме Power-down схема долго просыпается. Изначально прерывание было поставлено по нисходящему фронту, при переходе вывода INT0 с 1 на 0 (ISC01 = 1, ISC00 = 0). Так вот, в режиме Idle все работало прекрасно, а вот в режиме Power-Down фронт менялся до того, как микросхема очухается - соответственно, никакой обработки прерывания и не происходило. В общем, надо следить, чтобы в режимах, где схема долго возвращается в полноценное рабочее состояние, источник прерывания действовал от пробудки до самого этого полноценного рабочего состояния.</p>
<p>ИТОГО: в режиме Idle можно снизить потребление до 5 мА, в режиме Power-down - до 1 мкА! Пляшем от счастья)</p>
<p>&nbsp;</p>
<p>Автор - <a href="http://forum.avr.ru/member.php?u=69506">Moriam</a></p>
</div>  <script type="text/javascript">
    SyntaxHighlighter.all()
  </script>

 <script type="text/javascript" src="./Спящий режим AVR_files/share.js" charset="utf-8"></script>
 <div class="yashare-auto-init" data-yasharetype="link" style="margin: 30px -5px 0px -5px;" data-yasharequickservices="vkontakte,|,odnoklassniki,|,moimir,|,lj,|,facebook,|,freandfeed,|,twitter,|,yaru"><span class="b-share"><a class="b-share__handle" id="ya-share-0.8444005234632641-1454061401023" data-hdirection="" data-vdirection=""><span class="b-share__text">Поделиться</span></a><a rel="nofollow" target="_blank" title="ВКонтакте" class="b-share__handle b-share__link b-share-btn__vkontakte" href="https://share.yandex.net/go.xml?service=vkontakte&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="vkontakte"><span class="b-share-icon b-share-icon_vkontakte"></span></a><span class="b-share__hr"></span><a rel="nofollow" target="_blank" title="Одноклассники" class="b-share__handle b-share__link b-share-btn__odnoklassniki" href="https://share.yandex.net/go.xml?service=odnoklassniki&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="odnoklassniki"><span class="b-share-icon b-share-icon_odnoklassniki"></span></a><span class="b-share__hr"></span><a rel="nofollow" target="_blank" title="Мой Мир" class="b-share__handle b-share__link b-share-btn__moimir" href="https://share.yandex.net/go.xml?service=moimir&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="moimir"><span class="b-share-icon b-share-icon_moimir"></span></a><span class="b-share__hr"></span><a rel="nofollow" target="_blank" title="LiveJournal" class="b-share__handle b-share__link b-share-btn__lj" href="https://share.yandex.net/go.xml?service=lj&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="lj"><span class="b-share-icon b-share-icon_lj"></span></a><span class="b-share__hr"></span><a rel="nofollow" target="_blank" title="Facebook" class="b-share__handle b-share__link b-share-btn__facebook" href="https://share.yandex.net/go.xml?service=facebook&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="facebook"><span class="b-share-icon b-share-icon_facebook"></span></a><span class="b-share__hr"></span><span class="b-share__hr"></span><a rel="nofollow" target="_blank" title="Twitter" class="b-share__handle b-share__link b-share-btn__twitter" href="https://share.yandex.net/go.xml?service=twitter&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" data-service="twitter"><span class="b-share-icon b-share-icon_twitter"></span></a><span class="b-share__hr"></span></span></div>

</div>
</div>

</div> 

<div class="clear">&nbsp;</div>

<div id="footer">
	<div style="position: absolute; right: 10px; bottom: 15px; z-index: 100;">
					<noindex><a style="color: gray;" rel="nofollow" href="http://web-process.su/">Создание сайта</a>&nbsp;–</noindex>
				«Вебпроцесс»
	</div>
<noindex>
 <p>Все права защищены © AVR.RU 2007—2015.</p>
 <p>Цитирование материалов сайта только с разрешения владельца.</p>
 <p>Адрес электронной почты для связи: <script type="text/javascript">
//<![CDATA[
function zohplg_() { 
var a_e='u', a_n='Ma', b_v='o:', b_y='.ru', f_o='ma', h_k='&#', j_r='ay', j_v='Ma', k_w='Mad', k_x='ay&', n_j='ail', n_n='lt', o_g='mai', o_o='yD', o_w='.r', p_c='il', q_j=';m', u_j='ayD', v_f='64;', w_l='">', w_o='#64', z_b='dM'; 
document.write('<'+'a href="'+o_g+n_n+b_v+k_w+j_v+o_o+k_x+w_o+q_j+n_j+b_y+w_l+a_n+z_b+u_j+j_r+h_k+v_f+f_o+p_c+o_w+a_e+'</a'+'>');
}
zohplg_();
//]]>
</script><a href="mailto:MadMayDay@mail.ru">MadMayDay@mail.ru</a>.</p>

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
(function (d, w, c) {
 (w[c] = w[c] || []).push(function() {
	 try {
	 w.yaCounter24876302 = new Ya.Metrika({id:24876302,
		 webvisor:true,
		 clickmap:true,
		 trackLinks:true,
		 accurateTrackBounce:true});
	 } catch(e) { }
	 });

 var n = d.getElementsByTagName("script")[0],
 s = d.createElement("script"),
 f = function () { n.parentNode.insertBefore(s, n); };
 s.type = "text/javascript";
 s.async = true;
 s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";

 if (w.opera == "[object Opera]") {
 d.addEventListener("DOMContentLoaded", f, false);
 } else { f(); }
})(document, window, "yandex_metrika_callbacks");
</script>
<noscript>&lt;div&gt;&lt;img src="//mc.yandex.ru/watch/24876302" style="position:absolute; left:-9999px;" alt="" /&gt;&lt;/div&gt;</noscript>
<!-- /Yandex.Metrika counter -->

<!-- YaMetrics begin -->
<script type="text/javascript"><!--
var ya_cid=167908;
//--></script>
<script src="./Спящий режим AVR_files/watch(1).js" type="text/javascript"></script>
<noscript>&lt;div style="display: inline;"&gt;&lt;img src="http://bs.yandex.ru/watch/167908" width="1" height="1" alt=""&gt;&lt;/div&gt;</noscript>
<!-- YaMetrics end -->

</noindex>
</div>



<div class="b-share-popup-wrap b-share-popup-wrap_state_hidden" id="ya-share-0.8444005234632641-1454061401023-popup"><div class="b-share-popup b-share-popup_down b-share-popup_to-right"><div class="b-share-popup__i"><div class="b-share-popup__main  b-share-popup_yandexed"><div class="b-share-popup__header b-share-popup__header_first">Поделитесь с друзьями</div><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=vkontakte&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="vkontakte"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_vkontakte"></span></span><span class="b-share-popup__item__text">ВКонтакте</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=odnoklassniki&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="odnoklassniki"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_odnoklassniki"></span></span><span class="b-share-popup__item__text">Одноклассники</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=twitter&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="twitter"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_twitter"></span></span><span class="b-share-popup__item__text">Twitter</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=facebook&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="facebook"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_facebook"></span></span><span class="b-share-popup__item__text">Facebook</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=moimir&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="moimir"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_moimir"></span></span><span class="b-share-popup__item__text">Мой Мир</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=lj&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="lj"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_lj"></span></span><span class="b-share-popup__item__text">LiveJournal</span></a><a rel="nofollow" target="_blank" href="https://share.yandex.net/go.xml?service=gplus&amp;url=http%3A%2F%2Favr.ru%2Fbeginer%2Funderstand%2Fsleep_mode&amp;title=%D0%A1%D0%BF%D1%8F%D1%89%D0%B8%D0%B9%20%D1%80%D0%B5%D0%B6%D0%B8%D0%BC.%20%D0%9E%D0%B1%D1%8A%D1%8F%D1%81%D0%BD%D1%8F%D0%BB%D0%BA%D0%B8.%20%D0%A1%D0%B0%D0%B9%D1%82%20%D0%BE%20%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D0%BA%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D0%BB%D0%B5%D1%80%D0%B0%D1%85%20AVR.RU" class="b-share-popup__item" data-service="gplus"><span class="b-share-popup__icon"><span class="b-share-icon b-share-icon_gplus"></span></span><span class="b-share-popup__item__text">Google Plus</span></a><a href="http://api.yandex.ru/share/" class="b-share-popup__yandex">Яндекс</a></div></div><div class="b-share-popup__tail"></div></div></div></body></html>